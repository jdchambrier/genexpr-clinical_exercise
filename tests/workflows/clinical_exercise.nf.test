nextflow_workflow {

    name "Test Workflow CLINICALEXERCISE"
    script "workflows/clinical_exercise.nf"
    workflow "CLINICALEXERCISE"

    test("Should run without failures") {

        when {
            params {
                
                input = "${projectDir}/test_data/test_data.csv"
                managementrmd = "${projectDir}/bin/management.Rmd"
                dermd   = "${projectDir}/bin/de_analysis.Rmd"

                gender  = 'MALE'

            }
        }

        then {
            assert workflow.success

            with(workflow.out) {
                //  nf-test for data management
                assert clean_data.size() == 1
                assert snapshot(clean_data).match("clean_data")
                // nf-test for biomarker analysis
                assert significance_results.size() == 1
                assert snapshot(significance_results).match("significance_results")
            }
        }

    }

}
